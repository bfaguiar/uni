<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sofs17: mksofs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sofs17
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">FUSE based file system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__mksofs.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mksofs<div class="ingroups"><a class="el" href="group__rawlevel.html">rawlevel</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Formatting functions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaefc925eb94d4c27f41ca6a5d41af24c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mksofs.html#gaefc925eb94d4c27f41ca6a5d41af24c2">computeStructure</a> (uint32_t ntotal, uint32_t itotal, uint32_t *itsizep, uint32_t *rmsizep, uint32_t *ctotalp)</td></tr>
<tr class="memdesc:gaefc925eb94d4c27f41ca6a5d41af24c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes the structural division of the disk  <a href="#gaefc925eb94d4c27f41ca6a5d41af24c2">More...</a><br /></td></tr>
<tr class="separator:gaefc925eb94d4c27f41ca6a5d41af24c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga123eca8414d963b05d68775fed89e359"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mksofs.html#ga123eca8414d963b05d68775fed89e359">fillInSuperBlock</a> (const char *name, uint32_t ntotal, uint32_t itsize, uint32_t rmsize)</td></tr>
<tr class="memdesc:ga123eca8414d963b05d68775fed89e359"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill in the fields of the superblock.  <a href="#ga123eca8414d963b05d68775fed89e359">More...</a><br /></td></tr>
<tr class="separator:ga123eca8414d963b05d68775fed89e359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39e5597465776d1d714de103b0893877"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mksofs.html#ga39e5597465776d1d714de103b0893877">fillInInodeTable</a> (uint32_t itstart, uint32_t itsize)</td></tr>
<tr class="memdesc:ga39e5597465776d1d714de103b0893877"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill in the blocks of the inode table.  <a href="#ga39e5597465776d1d714de103b0893877">More...</a><br /></td></tr>
<tr class="separator:ga39e5597465776d1d714de103b0893877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7409457e516e08c9ce4f9dd5ea75431f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mksofs.html#ga7409457e516e08c9ce4f9dd5ea75431f">fillInFreeClusterTable</a> (uint32_t rmstart, uint32_t ctotal)</td></tr>
<tr class="memdesc:ga7409457e516e08c9ce4f9dd5ea75431f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill in the blocks of the free cluster table.  <a href="#ga7409457e516e08c9ce4f9dd5ea75431f">More...</a><br /></td></tr>
<tr class="separator:ga7409457e516e08c9ce4f9dd5ea75431f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2d37352b55fee1684380e5ab4d11d38"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mksofs.html#gad2d37352b55fee1684380e5ab4d11d38">fillInRootDir</a> (uint32_t rtstart)</td></tr>
<tr class="memdesc:gad2d37352b55fee1684380e5ab4d11d38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill in the root directory.  <a href="#gad2d37352b55fee1684380e5ab4d11d38">More...</a><br /></td></tr>
<tr class="separator:gad2d37352b55fee1684380e5ab4d11d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga888980275ff1db2334a07784a4109efd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mksofs.html#ga888980275ff1db2334a07784a4109efd">resetClusters</a> (uint32_t cstart, uint32_t ctotal)</td></tr>
<tr class="memdesc:ga888980275ff1db2334a07784a4109efd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill with zeros the given set of clusters.  <a href="#ga888980275ff1db2334a07784a4109efd">More...</a><br /></td></tr>
<tr class="separator:ga888980275ff1db2334a07784a4109efd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Formatting functions. </p>
<dl class="section author"><dt>Author</dt><dd>Artur Pereira - 2007-2009, 2016-2017 </dd>
<dd>
Miguel Oliveira e Silva - 2009, 2017 </dd>
<dd>
Ant√≥nio Rui Borges - 2010-2015 </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaefc925eb94d4c27f41ca6a5d41af24c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaefc925eb94d4c27f41ca6a5d41af24c2">&#9670;&nbsp;</a></span>computeStructure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeStructure </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ntotal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>itotal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>itsizep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>rmsizep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>ctotalp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes the structural division of the disk </p>
<p>The structural division is computed, possible adjusting the number of inodes in order to use the whole disk. If the given number of inodes is zero, a default value, equal to the number of blocks divided by 8, is used. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ntotal</td><td>total number of blocks of the device </td></tr>
    <tr><td class="paramname">itotal</td><td>requested number of inodes </td></tr>
    <tr><td class="paramname">itsizep</td><td>pointer to mem where to store the size of inode table in blocks </td></tr>
    <tr><td class="paramname">rmsizep</td><td>pointer to mem where to store the size of cluster reference table in blocks </td></tr>
    <tr><td class="paramname">ctotalp</td><td>pointer to mem where to store the number of clusters </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7409457e516e08c9ce4f9dd5ea75431f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7409457e516e08c9ce4f9dd5ea75431f">&#9670;&nbsp;</a></span>fillInFreeClusterTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillInFreeClusterTable </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rmstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ctotal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill in the blocks of the free cluster table. </p>
<p>There is a one to one correspondence between bits in the table and clusters. Bits on the table are considered to grow up from lower blocks to upper blocks, from lower bytes to upper bytes, and from most significant bits (MSB) to least significant bits (LSB). Thus, bit 0 corresponds to the most significant bit of the first byte of first block of the table. A bit at 1 means the corresponding cluster is free. Conversely, a bit at 0 means the corresponding cluster is in use. Bit 0, as the root occupies the first cluster, must be set in use. The number of bits in the table is, in general, greater than the number of clusters. The non used bits should be put as in use. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rmstart</td><td>the number of the fisrt block used by the bit table </td></tr>
    <tr><td class="paramname">ctotal</td><td>the total number of clusters </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga39e5597465776d1d714de103b0893877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39e5597465776d1d714de103b0893877">&#9670;&nbsp;</a></span>fillInInodeTable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillInInodeTable </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>itstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>itsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill in the blocks of the inode table. </p>
<p>The inode 0 must be filled assuming it is used by the root directory. The other inodes are free </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">itstart</td><td>physical number of the first block used by the inode table </td></tr>
    <tr><td class="paramname">itsize</td><td>number of blocks of the inode table </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gad2d37352b55fee1684380e5ab4d11d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad2d37352b55fee1684380e5ab4d11d38">&#9670;&nbsp;</a></span>fillInRootDir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillInRootDir </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rtstart</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill in the root directory. </p>
<p>The root directory occupies one cluster, with the first two slots filled in with "." and ".." directory entries. The other slots must be cleaned: field <code>name</code> filled with zeros and field <code>inode</code> filled with <code>NullReference</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rtstart</td><td>number of the block where the root cluster starts. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga123eca8414d963b05d68775fed89e359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga123eca8414d963b05d68775fed89e359">&#9670;&nbsp;</a></span>fillInSuperBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fillInSuperBlock </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ntotal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>itsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rmsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill in the fields of the superblock. </p>
<p>The magic number should be put at 0xFFFF. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>volume name </td></tr>
    <tr><td class="paramname">ntotal</td><td>the total number of blocks in the device </td></tr>
    <tr><td class="paramname">itsize</td><td>the number of blocks used by the inode table </td></tr>
    <tr><td class="paramname">rmsize</td><td>the number of blocks used by the cluster reference table </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga888980275ff1db2334a07784a4109efd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga888980275ff1db2334a07784a4109efd">&#9670;&nbsp;</a></span>resetClusters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resetClusters </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>cstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>ctotal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill with zeros the given set of clusters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cstart</td><td>number of the block of the first free cluster </td></tr>
    <tr><td class="paramname">ctotal</td><td>number of clusters to be filled </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
